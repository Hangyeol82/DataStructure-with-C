# Extendible Hash (확장 해시)

 **C 언어로 구현한 확장 해시 테이블**  
- **기본 원리**  
  - 확장 해시는 **이중 해시 디렉토리 구조**를 사용하여 **동적으로 크기가 변하는 해시 테이블**입니다.  
  - 디렉토리(Directory)의 크기는 항상 `2^global_depth`이며, 각 엔트리는 **버킷(Bucket)**을 가리킵니다.  
  - 각 버킷은 `local_depth`를 가지며, 디렉토리에서 몇 비트를 해시 값으로 사용했는지를 나타냅니다.  
  - 충돌(버킷 오버플로우)이 발생하면:
    1. **버킷 분할** (local_depth 증가)  
    2. 필요 시 **디렉토리 크기 2배 확장** (global_depth 증가)  
  - 반대로 삭제 시 버킷이 비면, **병합(Merge)** 후 필요하면 **디렉토리 크기 축소**가 일어납니다.

- **구현 특징**
  - 한 버킷에 최대 `MAX_SLOT=4`개의 학생을 저장합니다.
  - 디렉토리 크기(`size`)는 `2^global_depth`.
  - 충돌은 선형 체이닝이 아니라, **버킷 분할과 디렉토리 확장**으로 해결합니다.
  - 삭제 시 `local_depth`와 `global_depth`를 동적으로 줄이는 로직이 포함되어 있습니다.
  - 동적 메모리 할당(`malloc`, `calloc`, `realloc`)을 사용합니다.

---

## 주요 함수 설명

### 1. `hash_fun(int n, int k)`
- **역할**: 주어진 키의 하위 `k`비트를 추출해 인덱스를 계산.
- **동작 원리**
  1. `(1 << k) - 1` 로 `k`비트 마스크 생성.
  2. `n & mask` 연산으로 디렉토리 인덱스 반환.
- **시간 복잡도**: O(1)

---

### 2. `bucket_split(Bucket *cur, int index)`
- **역할**: 버킷이 가득 찼을 때 분할하거나, 필요하면 디렉토리를 2배 확장.
- **알고리즘 단계**
  1. `local_depth == global_depth`이면:
     - 디렉토리 크기를 2배(`size*2`)로 늘림.
     - 새 절반에 기존 포인터 복사.
     - `global_depth++`.
  2. 새로운 버킷 생성 후 기존 엔트리 재분배.
  3. 해당 버킷을 참조하는 디렉토리 엔트리를 교체.
- **시간 복잡도**: O(n) (분할 시 재분배 필요)

---

### 3. `insert(int id, char name[])`
- **역할**: 학생 정보를 확장 해시에 삽입.
- **동작 원리**
  1. `hash_fun(id, global_depth)`로 인덱스 찾기.
  2. 해당 버킷이 꽉 차면 `bucket_split()` 실행 후 다시 시도.
  3. 공간이 있으면 `slot[]` 배열에 삽입.
- **시간 복잡도**: 평균 O(1), 분할 발생 시 O(n)

---

### 4. `delete(int id)`
- **역할**: 특정 학생 정보를 삭제하고, 필요 시 버킷 병합 및 디렉토리 축소 수행.
- **동작 원리**
  1. 인덱스에서 버킷 검색 후 대상 삭제.
  2. 버킷이 비면, **짝꿍 버킷(buddy)** 확인 후 병합.
  3. 병합 후 `local_depth` 감소, 필요 시 `global_depth--`.
- **시간 복잡도**: 평균 O(1), 병합 발생 시 O(n)

---

### 5. `retrieve(int id)`
- **역할**: 특정 ID의 학생 이름을 검색 후 출력.
- **동작 원리**
  1. `hash_fun(id, global_depth)`로 인덱스 찾기.
  2. 버킷 내 선형 탐색으로 확인.
  3. 존재하면 이름 출력, 없으면 실패 메시지.
- **시간 복잡도**: O(1) (버킷 크기 제한적)

---

### 6. `update(int id, char name[])`
- **역할**: 특정 ID의 학생 이름을 새 값으로 갱신.
- **동작 원리**
  1. `retrieve`와 동일하게 버킷 탐색.
  2. 존재하면 이름 문자열 교체 후 출력.
- **시간 복잡도**: O(1)

---

### 7. `free_ext_hash()`
- **역할**: 확장 해시의 모든 버킷과 디렉토리를 해제.
- **동작 원리**
  1. 디렉토리를 순회하며 고유한 버킷만 free().
  2. 디렉토리 배열 free().
- **시간 복잡도**: O(n)

---

### 8. `dump_dir()`
- **역할**: 디버깅용, 현재 디렉토리와 버킷 상태 출력.
